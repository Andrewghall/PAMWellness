(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34288,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},39059,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n={assign:function(){return l},searchParamsToUrlQuery:function(){return i},urlQueryToSearchParams:function(){return o}};for(var r in n)Object.defineProperty(a,r,{enumerable:!0,get:n[r]});function i(e){let t={};for(let[a,n]of e.entries()){let e=t[a];void 0===e?t[a]=n:Array.isArray(e)?e.push(n):t[a]=[e,n]}return t}function s(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function o(e){let t=new URLSearchParams;for(let[a,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)t.append(a,s(e));else t.set(a,s(n));return t}function l(e,...t){for(let a of t){for(let t of a.keys())e.delete(t);for(let[t,n]of a.entries())e.append(t,n)}return e}},6065,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n={formatUrl:function(){return o},formatWithValidation:function(){return c},urlObjectKeys:function(){return l}};for(var r in n)Object.defineProperty(a,r,{enumerable:!0,get:n[r]});let i=e.r(72920)._(e.r(39059)),s=/https?|ftp|gopher|file/;function o(e){let{auth:t,hostname:a}=e,n=e.protocol||"",r=e.pathname||"",o=e.hash||"",l=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:a&&(c=t+(~a.indexOf(":")?`[${a}]`:a),e.port&&(c+=":"+e.port)),l&&"object"==typeof l&&(l=String(i.urlQueryToSearchParams(l)));let d=e.search||l&&`?${l}`||"";return n&&!n.endsWith(":")&&(n+=":"),e.slashes||(!n||s.test(n))&&!1!==c?(c="//"+(c||""),r&&"/"!==r[0]&&(r="/"+r)):c||(c=""),o&&"#"!==o[0]&&(o="#"+o),d&&"?"!==d[0]&&(d="?"+d),r=r.replace(/[?#]/g,encodeURIComponent),d=d.replace("#","%23"),`${n}${c}${r}${d}${o}`}let l=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return o(e)}},43155,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"useMergedRef",{enumerable:!0,get:function(){return r}});let n=e.r(20783);function r(e,t){let a=(0,n.useRef)(null),r=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=a.current;e&&(a.current=null,e());let t=r.current;t&&(r.current=null,t())}else e&&(a.current=i(e,n)),t&&(r.current=i(t,n))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),t.exports=a.default)},41316,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n={DecodeError:function(){return f},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return y},NormalizeError:function(){return v},PageNotFoundError:function(){return b},SP:function(){return g},ST:function(){return h},WEB_VITALS:function(){return i},execOnce:function(){return s},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return l},isResSent:function(){return p},loadGetInitialProps:function(){return x},normalizeRepeatedSlashes:function(){return m},stringifyError:function(){return k}};for(var r in n)Object.defineProperty(a,r,{enumerable:!0,get:n[r]});let i=["CLS","FCP","FID","INP","LCP","TTFB"];function s(e){let t,a=!1;return(...n)=>(a||(a=!0,t=e(...n)),t)}let o=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,l=e=>o.test(e);function c(){let{protocol:e,hostname:t,port:a}=window.location;return`${e}//${t}${a?":"+a:""}`}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function p(e){return e.finished||e.headersSent}function m(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function x(e,t){let a=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await x(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(a&&p(a))return n;if(!n)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${n}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let g="u">typeof performance,h=g&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class f extends Error{}class v extends Error{}class b extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class y extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function k(e){return JSON.stringify({message:e.message,stack:e.stack})}},61836,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"isLocalURL",{enumerable:!0,get:function(){return i}});let n=e.r(41316),r=e.r(31142);function i(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let t=(0,n.getLocationOrigin)(),a=new URL(e,t);return a.origin===t&&(0,r.hasBasePath)(a.pathname)}catch(e){return!1}}},34260,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"errorOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},84984,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n={default:function(){return f},useLinkStatus:function(){return b}};for(var r in n)Object.defineProperty(a,r,{enumerable:!0,get:n[r]});let i=e.r(72920),s=e.r(14806),o=i._(e.r(20783)),l=e.r(6065),c=e.r(4685),d=e.r(43155),u=e.r(41316),p=e.r(7402);e.r(34288);let m=e.r(13077),x=e.r(61836),g=e.r(56272);function h(e){return"string"==typeof e?e:(0,l.formatUrl)(e)}function f(t){var a;let n,r,i,[l,f]=(0,o.useOptimistic)(m.IDLE_LINK_STATUS),b=(0,o.useRef)(null),{href:y,as:j,children:k,prefetch:P=null,passHref:w,replace:N,shallow:C,scroll:S,onClick:A,onMouseEnter:R,onTouchStart:T,legacyBehavior:I=!1,onNavigate:E,ref:O,unstable_dynamicOnHover:M,..._}=t;n=k,I&&("string"==typeof n||"number"==typeof n)&&(n=(0,s.jsx)("a",{children:n}));let L=o.default.useContext(c.AppRouterContext),B=!1!==P,D=!1!==P?null===(a=P)||"auto"===a?g.FetchStrategy.PPR:g.FetchStrategy.Full:g.FetchStrategy.PPR,{href:$,as:U}=o.default.useMemo(()=>{let e=h(y);return{href:e,as:j?h(j):e}},[y,j]);if(I){if(n?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});r=o.default.Children.only(n)}let F=I?r&&"object"==typeof r&&r.ref:O,q=o.default.useCallback(e=>(null!==L&&(b.current=(0,m.mountLinkInstance)(e,$,L,D,B,f)),()=>{b.current&&((0,m.unmountLinkForCurrentNavigation)(b.current),b.current=null),(0,m.unmountPrefetchableInstance)(e)}),[B,$,L,D,f]),G={ref:(0,d.useMergedRef)(q,F),onClick(t){I||"function"!=typeof A||A(t),I&&r.props&&"function"==typeof r.props.onClick&&r.props.onClick(t),!L||t.defaultPrevented||function(t,a,n,r,i,s,l){if("u">typeof window){let c,{nodeName:d}=t.currentTarget;if("A"===d.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,x.isLocalURL)(a)){i&&(t.preventDefault(),location.replace(a));return}if(t.preventDefault(),l){let e=!1;if(l({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:u}=e.r(5848);o.default.startTransition(()=>{u(n||a,i?"replace":"push",s??!0,r.current)})}}(t,$,U,b,N,S,E)},onMouseEnter(e){I||"function"!=typeof R||R(e),I&&r.props&&"function"==typeof r.props.onMouseEnter&&r.props.onMouseEnter(e),L&&B&&(0,m.onNavigationIntent)(e.currentTarget,!0===M)},onTouchStart:function(e){I||"function"!=typeof T||T(e),I&&r.props&&"function"==typeof r.props.onTouchStart&&r.props.onTouchStart(e),L&&B&&(0,m.onNavigationIntent)(e.currentTarget,!0===M)}};return(0,u.isAbsoluteUrl)(U)?G.href=U:I&&!w&&("a"!==r.type||"href"in r.props)||(G.href=(0,p.addBasePath)(U)),i=I?o.default.cloneElement(r,G):(0,s.jsx)("a",{..._,...G,children:n}),(0,s.jsx)(v.Provider,{value:l,children:i})}e.r(34260);let v=(0,o.createContext)(m.IDLE_LINK_STATUS),b=()=>(0,o.useContext)(v);("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),t.exports=a.default)},85714,e=>{"use strict";var t=e.i(14806),a=e.i(84984),n=e.i(20783);let r=[{id:"pre-care",order:1,patient:{stageTitle:"Pre-care Portal",mindset:"Preparing for care and seeking clarity.",context:"Patient logs in, completes pre-care information, and initiates support before live care begins."},pam:{stageTitle:"Prepare & Guide",objective:"Reduce uncertainty and ensure readiness for assessment and triage."},aiInvolvement:{aiPercent:80,humanPercent:20},emotionalState:"moderate",governanceLine:"AI leads – humans approve.",ohioBlockers:["Repeated education","Unstructured FAQs"],aiBehaviours:["Summarise eligibility criteria","Provide personalised guidance scripts","Pre-populate intake forms"],personaParticipation:{Client:{active:!1,notes:""},Patient:{active:!0,notes:"Portal entry and information capture."},Clinicians:{active:!0,notes:"Receives pre-care context."},AgentClinicians:{active:!0,notes:"Coordinates intake readiness."},Regulator:{active:!0,notes:"Consent and data handling requirements."},PAMExecutives:{active:!1,notes:""}}},{id:"access-onboarding",order:2,patient:{stageTitle:"Access and Onboarding",mindset:"Confirming eligibility and getting registered.",context:"Eligibility, consent, and registration are confirmed, and baseline information is captured."},pam:{stageTitle:"Verify & Register",objective:"Confirm eligibility and capture complete baseline data."},aiInvolvement:{aiPercent:70,humanPercent:30},emotionalState:"moderate",governanceLine:"AI leads – humans approve.",ohioBlockers:["Manual eligibility checks","Duplicate data entry"],aiBehaviours:["Auto-verify eligibility","Pre-fill registration fields","Flag incomplete data"],personaParticipation:{Client:{active:!0,notes:"Confirms employee eligibility."},Patient:{active:!0,notes:"Completes registration."},Clinicians:{active:!1,notes:""},AgentClinicians:{active:!0,notes:"Validates intake completeness."},Regulator:{active:!0,notes:"Consent tracking."},PAMExecutives:{active:!1,notes:""}}},{id:"initial-assessment",order:3,patient:{stageTitle:"Initial Assessment",mindset:"Sharing details and hoping for quick understanding.",context:"Needs are assessed clinically and operationally to determine the right support pathway."},pam:{stageTitle:"Assess & Stratify",objective:"Capture clinical and operational needs to determine pathway."},aiInvolvement:{aiPercent:60,humanPercent:40},emotionalState:"high",governanceLine:"AI supports – humans decide.",ohioBlockers:["Incomplete referral data","Missing risk indicators"],aiBehaviours:["Extract key clinical indicators","Suggest risk stratification","Generate assessment summary"],personaParticipation:{Client:{active:!1,notes:""},Patient:{active:!0,notes:"Provides clinical history."},Clinicians:{active:!0,notes:"Reviews and validates assessment."},AgentClinicians:{active:!0,notes:"Prepares case summary."},Regulator:{active:!0,notes:"Clinical documentation standards."},PAMExecutives:{active:!1,notes:""}}},{id:"triage-routing",order:4,patient:{stageTitle:"Triage and Routing",mindset:"Waiting to be matched with the right support.",context:"Case is matched to pathway, clinician type, urgency, and service model."},pam:{stageTitle:"Match & Route",objective:"Ensure optimal matching to pathway and clinician."},aiInvolvement:{aiPercent:75,humanPercent:25},emotionalState:"moderate",governanceLine:"AI leads – humans approve.",ohioBlockers:["Manual triage delays","Suboptimal clinician matching"],aiBehaviours:["Recommend pathway match","Suggest clinician based on availability","Flag urgent cases"],personaParticipation:{Client:{active:!1,notes:""},Patient:{active:!0,notes:"Awaits routing confirmation."},Clinicians:{active:!0,notes:"Receives assigned cases."},AgentClinicians:{active:!0,notes:"Executes routing logic."},Regulator:{active:!1,notes:""},PAMExecutives:{active:!0,notes:"Monitors capacity and routing efficiency."}}},{id:"care-delivery",order:5,patient:{stageTitle:"Care Delivery",mindset:"Expecting high-quality sessions and consistent support.",context:"Sessions and interventions are delivered with high clinical quality."},pam:{stageTitle:"Deliver & Support",objective:"Deliver clinical interventions with quality and consistency."},aiInvolvement:{aiPercent:30,humanPercent:70},emotionalState:"stable",governanceLine:"Human-led – AI assists.",ohioBlockers:["Session preparation overhead","Inconsistent documentation"],aiBehaviours:["Prepare session briefs","Real-time note assistance","Post-session summary generation"],personaParticipation:{Client:{active:!1,notes:""},Patient:{active:!0,notes:"Receives care."},Clinicians:{active:!0,notes:"Leads clinical sessions."},AgentClinicians:{active:!0,notes:"Supports documentation."},Regulator:{active:!0,notes:"Clinical quality standards."},PAMExecutives:{active:!1,notes:""}}},{id:"ongoing-management",order:6,patient:{stageTitle:"Ongoing Case Management",mindset:"Seeking continuity and progress tracking.",context:"Coordination, continuity, adjustments, and progress tracking across the active case."},pam:{stageTitle:"Monitor & Adjust",objective:"Maintain engagement and adjust care as needed."},aiInvolvement:{aiPercent:55,humanPercent:45},emotionalState:"stable",governanceLine:"AI supports – humans decide.",ohioBlockers:["Manual progress tracking","Missed follow-ups"],aiBehaviours:["Track progress metrics","Proactive check-in reminders","Flag cases requiring attention"],personaParticipation:{Client:{active:!0,notes:"Receives progress updates."},Patient:{active:!0,notes:"Engages in ongoing care."},Clinicians:{active:!0,notes:"Reviews and adjusts care plans."},AgentClinicians:{active:!0,notes:"Coordinates follow-ups."},Regulator:{active:!1,notes:""},PAMExecutives:{active:!0,notes:"Reviews case outcomes."}}},{id:"outcomes-closure",order:7,patient:{stageTitle:"Outcomes and Closure",mindset:"Looking for clarity on progress and next steps.",context:"Outcomes are recorded and the case is closed with appropriate follow-up actions."},pam:{stageTitle:"Record & Close",objective:"Document outcomes and ensure appropriate closure."},aiInvolvement:{aiPercent:65,humanPercent:35},emotionalState:"stable",governanceLine:"AI leads – humans approve.",ohioBlockers:["Incomplete outcome recording","Manual discharge processes"],aiBehaviours:["Generate outcome summary","Recommend follow-up actions","Prepare closure documentation"],personaParticipation:{Client:{active:!0,notes:"Receives outcome report."},Patient:{active:!0,notes:"Reviews outcomes."},Clinicians:{active:!0,notes:"Approves closure."},AgentClinicians:{active:!0,notes:"Finalises documentation."},Regulator:{active:!0,notes:"Outcome reporting requirements."},PAMExecutives:{active:!0,notes:"Reviews aggregate outcomes."}}},{id:"reporting-governance",order:8,patient:{stageTitle:"Reporting and Governance",mindset:"Trusting that data is handled properly.",context:"Employer updates, operational insight, and compliance reporting occur throughout."},pam:{stageTitle:"Report & Govern",objective:"Provide transparency and ensure compliance."},aiInvolvement:{aiPercent:85,humanPercent:15},emotionalState:"stable",governanceLine:"AI leads – humans approve.",ohioBlockers:["Manual report generation","Delayed compliance updates"],aiBehaviours:["Auto-generate employer reports","Track compliance metrics","Flag governance issues"],personaParticipation:{Client:{active:!0,notes:"Receives aggregated reports."},Patient:{active:!1,notes:""},Clinicians:{active:!1,notes:""},AgentClinicians:{active:!0,notes:"Generates reports."},Regulator:{active:!0,notes:"Compliance oversight."},PAMExecutives:{active:!0,notes:"Reviews governance dashboards."}}},{id:"follow-on-reentry",order:9,patient:{stageTitle:"Follow-on and Re-entry",mindset:"Appreciating continuity rather than starting over.",context:"Support continues where needed, with continuity preserved rather than restarting."},pam:{stageTitle:"Continue & Reconnect",objective:"Preserve continuity and enable seamless re-engagement."},aiInvolvement:{aiPercent:70,humanPercent:30},emotionalState:"moderate",governanceLine:"AI leads – humans approve.",ohioBlockers:["Loss of case history","Restart friction"],aiBehaviours:["Retrieve prior case context","Recommend re-entry pathway","Pre-populate returning patient data"],personaParticipation:{Client:{active:!0,notes:"May initiate re-referral."},Patient:{active:!0,notes:"Returns for continued support."},Clinicians:{active:!0,notes:"Reviews prior history."},AgentClinicians:{active:!0,notes:"Facilitates re-entry."},Regulator:{active:!1,notes:""},PAMExecutives:{active:!1,notes:""}}}],i=[{id:"high",label:"High emotion / high clinical risk",color:"bg-red-500"},{id:"moderate",label:"Moderate emotion",color:"bg-amber-500"},{id:"stable",label:"Positive / stable",color:"bg-emerald-500"}];function s(){let e=(0,n.useRef)(null),[s,o]=(0,n.useState)(r),[l,c]=(0,n.useState)(r[0]?.id??""),[d,u]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),[x,g]=(0,n.useState)(!1),[h,f]=(0,n.useState)(null),[v,b]=(0,n.useState)(null),[y,j]=(0,n.useState)(null),k=s.find(e=>e.id===l)??null,P=(e,t)=>{o(a=>a.map(a=>a.id===e?{...a,patient:{...a.patient,...t}}:a))},w=(e,t)=>{o(a=>a.map(a=>a.id===e?{...a,pam:{...a.pam,...t}}:a))};return(0,t.jsx)("div",{className:"min-h-screen px-6 py-10",children:(0,t.jsxs)("div",{className:"mx-auto flex w-full max-w-7xl flex-col gap-6",children:[(0,t.jsxs)("section",{className:"card p-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-display text-xl",children:"Export & reset"}),(0,t.jsx)("p",{className:"text-sm text-[color:var(--ink-muted)]",children:"Export JSON, import JSON, or reset to default values. PNG snapshot via Preview."})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 text-sm",children:[(0,t.jsx)(a.default,{href:"/journey/preview",className:"rounded-full border border-black/10 bg-white px-4 py-2 text-black/70 transition hover:border-black/30",children:"Preview PNG"}),(0,t.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify({workshopId:"cmkpawx0f0001ky04lpv3658i",version:"1.0",updatedAt:new Date().toISOString(),stages:s},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`pam-journey-${new Date().toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(t)},className:"rounded-full border border-black/10 bg-black px-4 py-2 text-white",children:"Export JSON"}),(0,t.jsxs)("label",{className:"cursor-pointer rounded-full border border-black/10 bg-white px-4 py-2 text-sm text-black/70 transition hover:border-black/30",children:["Import JSON",(0,t.jsx)("input",{ref:e,type:"file",accept:"application/json",className:"hidden",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let a=new FileReader;a.onload=()=>{try{let e=JSON.parse(a.result);if(!e.stages||!Array.isArray(e.stages))return void f("Invalid JSON: missing stages array");o(e.stages),c(e.stages[0]?.id??""),f(null)}catch{f("Invalid JSON format")}},a.readAsText(t),e.target.value=""}})]}),(0,t.jsx)("button",{onClick:()=>u(!0),className:"rounded-full border border-black/10 bg-white px-4 py-2 text-black/70 transition hover:border-black/30",children:"Reset model"})]})]}),h&&(0,t.jsx)("div",{className:"mt-3 rounded-xl bg-red-50 px-4 py-2 text-sm text-red-700",children:h})]}),(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[7fr_3fr]",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-display text-2xl",children:"Journey stages"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 text-xs",children:i.map(e=>(0,t.jsxs)("span",{className:"flex items-center gap-2 rounded-full border border-black/10 bg-white px-3 py-1",children:[(0,t.jsx)("span",{className:`h-2 w-2 rounded-full ${e.color}`}),e.label]},e.id))})]}),(0,t.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,t.jsxs)("div",{id:e.id,onDragOver:e=>e.preventDefault(),onDragEnter:()=>j(e.id),onDragLeave:()=>j(null),onDrop:()=>{if(v){var t;v!==(t=e.id)&&o(e=>{let a=e.findIndex(e=>e.id===v),n=e.findIndex(e=>e.id===t);if(-1===a||-1===n)return e;let r=[...e],[i]=r.splice(a,1);return r.splice(n,0,i),r.map((e,t)=>({...e,order:t+1}))}),b(null)}j(null)},className:`relative flex rounded-2xl border transition ${l===e.id?"border-[color:var(--accent)] bg-white shadow-lg":"border-black/10 bg-white/80 hover:border-black/20"} ${y===e.id&&v!==e.id?"ring-2 ring-[color:var(--accent)]":""}`,children:[(0,t.jsx)("div",{draggable:!0,onDragStart:()=>b(e.id),onDragEnd:()=>{b(null),j(null)},className:"flex w-8 flex-shrink-0 cursor-grab items-center justify-center rounded-l-2xl border-r border-black/5 bg-slate-50 text-black/30 hover:bg-slate-100 hover:text-black/50 active:cursor-grabbing",children:(0,t.jsxs)("svg",{width:"10",height:"16",viewBox:"0 0 10 16",fill:"currentColor",children:[(0,t.jsx)("circle",{cx:"2",cy:"2",r:"1.5"}),(0,t.jsx)("circle",{cx:"8",cy:"2",r:"1.5"}),(0,t.jsx)("circle",{cx:"2",cy:"6",r:"1.5"}),(0,t.jsx)("circle",{cx:"8",cy:"6",r:"1.5"}),(0,t.jsx)("circle",{cx:"2",cy:"10",r:"1.5"}),(0,t.jsx)("circle",{cx:"8",cy:"10",r:"1.5"}),(0,t.jsx)("circle",{cx:"2",cy:"14",r:"1.5"}),(0,t.jsx)("circle",{cx:"8",cy:"14",r:"1.5"})]})}),(0,t.jsxs)("button",{onClick:()=>c(e.id),className:"flex-1 p-5 text-left",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"rounded bg-slate-100 px-2 py-0.5 text-xs font-medium text-slate-600",children:"PATIENT"}),(0,t.jsx)("span",{className:`h-2.5 w-2.5 rounded-full ${i.find(t=>t.id===e.emotionalState)?.color}`})]}),(0,t.jsx)("h3",{className:"mt-2 text-lg font-semibold text-black",children:e.patient.stageTitle}),(0,t.jsx)("p",{className:"mt-1 text-sm text-[color:var(--ink-muted)]",children:e.patient.mindset})]}),(0,t.jsxs)("div",{className:"md:text-right",children:[(0,t.jsx)("span",{className:"rounded bg-[color:var(--accent)]/10 px-2 py-0.5 text-xs font-medium text-[color:var(--accent)]",children:"PAM"}),(0,t.jsx)("p",{className:"mt-2 text-sm font-medium text-black",children:e.pam.stageTitle})]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-black/60",children:[(0,t.jsxs)("span",{children:["AI ",e.aiInvolvement.aiPercent,"%"]}),(0,t.jsxs)("span",{children:["Human ",e.aiInvolvement.humanPercent,"%"]})]}),(0,t.jsx)("div",{className:"mt-2 h-2 overflow-hidden rounded-full bg-black/10",children:(0,t.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-[color:var(--accent)] to-amber-400",style:{width:`${e.aiInvolvement.aiPercent}%`}})})]})]})]},e.id))}),(0,t.jsxs)("button",{onClick:()=>g(!0),className:"flex w-full items-center justify-center gap-2 rounded-2xl border-2 border-dashed border-black/20 bg-white/50 py-4 text-sm font-medium text-black/50 transition hover:border-[color:var(--accent)] hover:bg-[color:var(--accent)]/5 hover:text-[color:var(--accent)]",children:[(0,t.jsx)("span",{className:"text-lg",children:"+"}),"Add new stage"]})]}),(0,t.jsxs)("aside",{className:"rounded-2xl border border-black/10 bg-white p-6",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-black/50",children:"Stage detail"}),k?(0,t.jsxs)("div",{className:"mt-4 space-y-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"Patient stage"}),(0,t.jsx)("input",{value:k.patient.stageTitle,onChange:e=>P(k.id,{stageTitle:e.target.value}),className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"Patient mindset"}),(0,t.jsx)("input",{value:k.patient.mindset,onChange:e=>P(k.id,{mindset:e.target.value}),className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"Patient context"}),(0,t.jsx)("textarea",{value:k.patient.context,onChange:e=>P(k.id,{context:e.target.value}),className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm",rows:2})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"PAM stage"}),(0,t.jsx)("input",{value:k.pam.stageTitle,onChange:e=>w(k.id,{stageTitle:e.target.value}),className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"PAM objective"}),(0,t.jsx)("textarea",{value:k.pam.objective,onChange:e=>w(k.id,{objective:e.target.value}),className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm",rows:2})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"AI involvement"}),(0,t.jsx)("input",{type:"range",min:0,max:100,value:k.aiInvolvement.aiPercent,onChange:e=>{var t,a;return t=k.id,a=Number(e.target.value),void o(e=>e.map(e=>e.id===t?{...e,aiInvolvement:{aiPercent:a,humanPercent:100-a}}:e))},className:"mt-2 w-full"}),(0,t.jsxs)("div",{className:"mt-1 flex justify-between text-xs text-black/60",children:[(0,t.jsxs)("span",{children:["AI ",k.aiInvolvement.aiPercent,"%"]}),(0,t.jsxs)("span",{children:["Human ",k.aiInvolvement.humanPercent,"%"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"Emotional state"}),(0,t.jsx)("div",{className:"mt-2 grid gap-2",children:i.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>{var t,a;return t=k.id,a=e.id,void o(e=>e.map(e=>e.id===t?{...e,emotionalState:a}:e))},className:`flex items-center justify-between rounded-full border px-3 py-2 text-xs ${k.emotionalState===e.id?"border-black/40 bg-white":"border-black/10 bg-white/70"}`,children:[(0,t.jsx)("span",{children:e.label}),(0,t.jsx)("span",{className:`h-2 w-2 rounded-full ${e.color}`})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"OHIO blockers (comma separated)"}),(0,t.jsx)("input",{value:k.ohioBlockers.join(", "),onChange:e=>{var t,a;return t=k.id,a=e.target.value.split(",").map(e=>e.trim()).filter(Boolean),void o(e=>e.map(e=>e.id===t?{...e,ohioBlockers:a}:e))},className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"AI behaviours (comma separated)"}),(0,t.jsx)("input",{value:k.aiBehaviours.join(", "),onChange:e=>{var t,a;return t=k.id,a=e.target.value.split(",").map(e=>e.trim()).filter(Boolean),void o(e=>e.map(e=>e.id===t?{...e,aiBehaviours:a}:e))},className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"Governing statement"}),(0,t.jsx)("input",{value:k.governanceLine,onChange:e=>{var t,a;return t=k.id,a=e.target.value,void o(e=>e.map(e=>e.id===t?{...e,governanceLine:a}:e))},className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsx)("button",{type:"button",onClick:()=>m(!0),className:"mt-2 w-full rounded-full border border-red-200 bg-red-50 px-4 py-2 text-xs font-semibold text-red-600 transition hover:bg-red-100",children:"Delete stage"})]}):(0,t.jsx)("p",{className:"mt-4 text-sm text-[color:var(--ink-muted)]",children:"Select a stage to view detail."})]})]}),d&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white p-6",children:[(0,t.jsx)("h3",{className:"text-display text-xl",children:"Reset to default?"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-[color:var(--ink-muted)]",children:"This will discard all changes and restore the original 9 journey stages."}),(0,t.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>u(!1),className:"flex-1 rounded-full border border-black/10 px-4 py-2 text-sm",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{o(r),c(r[0]?.id??""),u(!1)},className:"flex-1 rounded-full bg-red-600 px-4 py-2 text-sm text-white",children:"Reset"})]})]})}),p&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white p-6",children:[(0,t.jsx)("h3",{className:"text-display text-xl",children:"Delete this stage?"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-[color:var(--ink-muted)]",children:"This action cannot be undone. The stage will be permanently removed."}),(0,t.jsxs)("div",{className:"mt-6 flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>m(!1),className:"flex-1 rounded-full border border-black/10 px-4 py-2 text-sm",children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>{let e=s.findIndex(e=>e.id===l),t=s.filter(e=>e.id!==l);o(t),c(t[Math.min(e,t.length-1)]?.id??""),m(!1)},className:"flex-1 rounded-full bg-red-600 px-4 py-2 text-sm text-white",children:"Delete"})]})]})}),x&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:(0,t.jsxs)("div",{className:"w-full max-w-md rounded-2xl bg-white p-6",children:[(0,t.jsx)("h3",{className:"text-display text-xl",children:"Add new stage"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-[color:var(--ink-muted)]",children:"Create a new journey stage. You can edit all details after creation."}),(0,t.jsxs)("form",{onSubmit:e=>{let t,a;e.preventDefault();let n=e.target,r=n.elements.namedItem("patientTitle").value,i=n.elements.namedItem("pamTitle").value;r&&i&&(a={id:t=`stage-${Date.now()}`,order:s.length+1,patient:{stageTitle:r,mindset:"Define the patient mindset for this stage.",context:"Describe the patient context and situation."},pam:{stageTitle:i,objective:"Define the PAM objective for this stage."},aiInvolvement:{aiPercent:50,humanPercent:50},emotionalState:"moderate",governanceLine:"AI supports – humans decide.",ohioBlockers:[],aiBehaviours:[],personaParticipation:{Client:{active:!1,notes:""},Patient:{active:!0,notes:""},Clinicians:{active:!0,notes:""},AgentClinicians:{active:!0,notes:""},Regulator:{active:!1,notes:""},PAMExecutives:{active:!1,notes:""}}},o(e=>[...e,a]),c(t),g(!1))},className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"Patient stage title"}),(0,t.jsx)("input",{name:"patientTitle",placeholder:"e.g., Initial Consultation",required:!0,className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-[0.2em] text-black/50",children:"PAM stage title"}),(0,t.jsx)("input",{name:"pamTitle",placeholder:"e.g., Assess & Guide",required:!0,className:"mt-2 w-full rounded-xl border border-black/10 bg-white px-3 py-2 text-sm"})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>g(!1),className:"flex-1 rounded-full border border-black/10 px-4 py-2 text-sm",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"flex-1 rounded-full bg-[color:var(--accent)] px-4 py-2 text-sm text-white",children:"Add stage"})]})]})]})})]})})}e.s(["default",()=>s])}]);